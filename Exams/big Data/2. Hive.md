
---

## üêù Apache Hive - Summary

### üìå What is Hive?

- Hive is a **data warehouse system** built on top of **Hadoop**.
    
- It uses:
    
    - **MapReduce** for query execution
        
    - **HDFS** for data storage
        
    - A **metastore** to manage metadata (e.g., table schemas)
        

#### üß± Key Principles:

- Familiar **SQL-like language** (HiveQL)
    
- **Extensible** with custom types, formats, functions
    
- Designed for **scalability** and **performance**
    

---

### üíª How Hive Works

- Runs on a **workstation** and converts SQL queries to **MapReduce jobs**.
    
- Organizes data in **tables**, adding schema to HDFS data.
    
- **Metastore** is used to manage metadata (can be a MySQL or Derby DB).
    

---

### üÜö Java vs Hive: Word Count Example

- Traditional Java MapReduce code involves explicit definition of Map & Reduce classes.
    
- Hive simplifies the same task with just two commands:
    
    ```sql
    CREATE TABLE docs (line STRING);
    LOAD DATA INPATH 'docs' OVERWRITE INTO TABLE docs;
    
    CREATE TABLE word_counts AS
    SELECT word, count(1) AS count FROM
      (SELECT explode(split(line, '\s')) AS word FROM docs)
    ORDER BY word;
    ```
    

---

### üß© Hive Components

- **Hive Shell**: Command-line interface to run HiveQL queries.
    
- **HiveServer2**: Allows external apps to connect via JDBC/ODBC.
    
- **Metastore**: Stores schema & metadata.
    
- **Execution Engine**: Converts HiveQL to execution plans using MapReduce.
    

---

### üìù HiveQL (Hive Query Language)

- Inspired by **SQL-92**, **MySQL**, and **Oracle SQL**.
    
- HiveQL is **case-insensitive** and supports many SQL-like operations.
    
- Syntax and functionality improving over time.
    

---

### üìÇ Tables in Hive

- Tables define structure over HDFS files.
    
    ```sql
    CREATE TABLE records (
      year STRING, temperature INT, quality INT
    )
    ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t';
    
    LOAD DATA LOCAL INPATH 'input/ncdc/sample.txt'
    OVERWRITE INTO TABLE records;
    ```
    
- Query example:
    
    ```sql
    SELECT year, MAX(temperature)
    FROM records
    WHERE temperature != 9999 AND quality IN (0,1,4,5,9)
    GROUP BY year;
    ```
    

---

### üóÉÔ∏è Managed vs External Tables

- **Managed Table**: Hive controls data (moves it to warehouse).
    
- **External Table**: Hive only refers to data stored elsewhere.
    
    ```sql
    CREATE EXTERNAL TABLE external_table (dummy STRING)
    LOCATION '/user/me/external_table';
    LOAD DATA INPATH '/user/me/data.txt' INTO TABLE external_table;
    ```
    

---

### üß© Partitions

- Breaks table into **logical parts** based on column values (e.g., `date`, `country`).
    
- Helps **optimize queries** via input pruning.
    
    ```sql
    CREATE TABLE logs (
      ts BIGINT, line STRING
    ) PARTITIONED BY (dt STRING, country STRING);
    
    LOAD DATA LOCAL INPATH 'input/hive/partitions/file1'
    INTO TABLE logs
    PARTITION (dt='2001-01-01', country='GB');
    ```
    
- File system reflects partition hierarchy:
    
    ```
    logs/
      dt=2001-01-01/country=GB/
      dt=2001-01-01/country=US/
    ```
    

---

### üß∫ Buckets

- Further subdivides partitions/tables into **buckets** (for fine-grained optimization).
    
- Example: bucketing by user ID.
    
    ```sql
    CREATE TABLE bucketed_users (
      id INT, name STRING
    ) CLUSTERED BY (id) INTO 4 BUCKETS;
    ```
    
- Useful for **sampling**, **joins**, and **map-side joins**.
    

---

### ‚úÖ Hive Summary Checklist:

|Feature|Purpose|
|---|---|
|HiveQL|Querying with SQL-like syntax|
|Metastore|Stores schema & metadata|
|Managed Table|Hive controls the data location|
|External Table|Data stays where it is|
|Partitions|Table slices by column values|
|Buckets|Data subdivision within partitions/tables|
|Execution Engine|Converts HiveQL to MapReduce|

---

üß† **Study Tip:** Focus especially on differences between managed/external tables, and how partitions and buckets help in query optimization. Also, understand how Hive abstracts MapReduce jobs using simple SQL.

Let me know if you want **quiz questions**, **flashcards**, or a **cheat sheet** version!